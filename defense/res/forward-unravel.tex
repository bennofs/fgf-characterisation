\begin{tikzpicture}
  \tikzset{el/.style={circle,draw,fill=white,minimum width=2em,minimum height=2em}};
  \def\radiusP{0.7em};
  \def\radiusE{0.4em};
  \def\radiusS{0.2em};
  \tikzset{relP/.style={tolhighcontrastBlue, line width=0.4em, -{Stealth[round]}, shorten >= 0.4em, radius=\radiusP}};
  \tikzset{relE/.style={tolhighcontrastYellow, line width=0.25em, -{Stealth[round]}, shorten >= 0.2em, radius=\radiusE}};
  \tikzset{relS/.style={tolhighcontrastRed, line width=0.15em, -{Stealth[round]}, shorten >= 0.2em, radius=\rediusS}};
  \tikzset{selnode/.style={white, fill=tolbrightGreen}}
  \tikzset{sel2node/.style={black, fill=tollightLightcyan}}
  \tikzset{sel3node/.style={black, fill=tollightLightyellow}}
  \tikzset{selnodex/.style={#1/.append style={selnode}}}
  \tikzset{sel2nodex/.style={#1/.append style={sel2node}}}
  \tikzset{sel3nodex/.style={#1/.append style={sel3node}}}

  \def\tupp{{\color{tolhighcontrastBlue}\elemtuplep}}%
  \def\tupe{{\color{tolbrightYellowDarkest}\elemtuplee}}%

  \begin{scope}
    \node[anchor=base west, font=\huge] (defif) { $\elemtuptupler \in \relR^{\unravel{A}}$ if };
    \node[text width=25em, right=1em of defif, font=\Large] (defconds) {
      \begin{enumerate}
        \item<alert@3> $\elemtuptupler$ projects to a tuple of $\relR$ in $\str{A}$,
        \item<alert@4> $\elemtuptupler$ is a path in $\unraveldom{A}$, and
        \item<alert@5> $|\elemtuptupler| \le b$, for $b$ s.t.\ $\mathtt{last}(\elemtuptupler) = \langle\ldots/b\rangle$.
      \end{enumerate}
    };
  \end{scope}

  \begin{scope}[every node/.style={uncover=<2->}, every path/.style={uncover=<2->}]
    \matrix[matrix of nodes, every node/.style={el},name=n,column sep=2em, row sep=2em, ampersand replacement=§, matrix anchor=1.base, below=5em of defif.south west, uncover=<2->]  {
      |(1)| a \\ |(2) [onslide=<5>selnode]| b \\ |(3) [onslide=<5>selnode]| c \\
    };
    \node[above=1.5ex of 1] (laba) {\huge{$\str{A}$}};
    \begin{scope}[font=\Large]
      \def\rP{\textcolor{tolhighcontrastBlue}{\mathbf{P}}};
      \def\rE{\textcolor{tolhighcontrastYellow}{\mathbf{E}}};
      \matrix [right=3em of laba.center, matrix anchor=head.west, anchor=base west, row sep=0.25em] {
        \node (head) {};     \\
        \node { $\tupp = (a,b,c)$ }; \\
        \node { $\tupe = (b,c)$ };   \\[0.25em]
        \node {}; \\
        \node { $\rP^{\str{A}} = \{ \tupp \}$ }; \\
        \node { $\rE^{\str{A}} = \{ \tupe \}$ }; \\
      };
    \end{scope}

    \begin{scope}[on background layer]
      \fill[relP] (1.west) circle [radius=\radiusP] coordinate (p1);
      \fill[relP] (2.west) circle [radius=\radiusP] coordinate (p2);
      \fill[relP] (3.west) circle [radius=\radiusP] coordinate (p3);
      \draw[relP] (p1) to[out=-150,in=150] (p2) to[out=-150,in=150] (p3);

      \fill[relE] (2.south) circle [radius=\radiusE] coordinate (p1);
      \fill[relE] (3.north) circle [radius=\radiusE] coordinate (p2);
      \draw[relE] (p1) to (p2);
    \end{scope}
  \end{scope}

  \begin{scope}[uncover=<2->]
    \matrix[matrix of nodes, every node/.style={draw,rectangle,rounded corners=3pt, fill=white}, ampersand replacement=§, row sep=2em, column sep=1.5em, below=2em of defconds.south, matrix anchor=p1.north] {
                                                      § |(p1)| $\langle \tupp / 1 \rangle$ §  \\
                                                      § |(p2)| $\langle \tupp / 2 \rangle$ § |(p11p2)| $\langle \tupp(1,1)\tupp / 2 \rangle$  \\
      |(p22e2)| $\langle \tupp(2,2)\tupe / 2 \rangle$ § |(p3)| $\langle \tupp / 3 \rangle$ § |(p11p3)| $\langle \tupp(1,1)\tupp / 3 \rangle$ \\
    };

    \graph[use existing nodes, edges={-{Stealth[round]}, thick}] {
      (p1) -> (p2) -> (p3),
      (p2) -> (p22e2),
      (p1) -> (p11p2) -> (p11p3),
    };
  \end{scope}


  \tikzset{relNotP/.style={tolhighcontrastRed, line width=0.4em, -{Stealth[round]}, shorten >= 0.4em, radius=\radiusP}};
  \begin{scope}[on background layer, every path/.style={uncover=<3>}]
    \fill[relNotP] (p1.south east) circle[] coordinate (c1);
    \fill[relNotP] (p2.east) circle[] coordinate (c2);
    \fill[relNotP] (p11p2.west) circle[] coordinate (c3);
    \draw[relNotP, dashed] (c1) to[out=-60, in=60] (c2) to[out=-30,in=-150] (c3);
  \end{scope}
  \begin{scope}[on background layer, every path/.style={uncover=<4>}]
    \fill[relNotP] (p1.south east) circle[] coordinate (c1);
    \fill[relNotP] (p2.east) circle[] coordinate (c2);
    \fill[relNotP] (p11p3.160) circle[] coordinate (c3);
    \draw[relNotP, dashed] (c1) to[out=-60, in=60] (c2) to[out=-45, in=145] (c3);
  \end{scope}
  \begin{scope}[on background layer, every path/.style={uncover=<5>}]
    \fill[relNotP] (p1.south west) circle[] coordinate (c1);
    \fill[relNotP] (p2.west) circle[] coordinate (c2);
    \fill[relNotP] (p22e2.north) circle[] coordinate (c3);
    \draw[relNotP, dashed] (c1) to[out=-120, in=120] (c2) to[out=-120, in=80] (c3);
  \end{scope}
  \begin{scope}[on background layer, every path/.style={uncover=<6->}]
    \fill[relP] (p1.south east) circle[] coordinate (c1);
    \fill[relP] (p2.east) circle[] coordinate (c2);
    \fill[relP] (p3.north east) circle[] coordinate (c3);
    \draw[relP] (c1) to[out=-60, in=60] (c2) to[out=-60, in=60] (c3);
  \end{scope}
  \begin{scope}[on background layer, every path/.style={uncover=<3->}]
    \fill[relP] (p1.north east) circle[] coordinate (c1);
    \fill[relP] (p11p2.east) circle[] coordinate (c2);
    \fill[relP] (p11p3.east) circle[] coordinate (c3);
    \draw[relP] (c1) to[out=-5, in=110] (c2) to[out=-80, in=80] (c3);
  \end{scope}
  \begin{scope}[on background layer, every path/.style={uncover=<6->}]
    \fill[relE] (p2.-170) circle[] coordinate (c1);
    \fill[relE] (p22e2.60) circle[] coordinate (c2);
    \draw[relE] (c1) to (c2);

    \fill[relE] (p2.south) ++(-0.5em, 0) circle[] coordinate (c1);
    \fill[relE] (p3.north) ++(-0.5em, 0) circle[] coordinate (c2);
    \draw[relE] (c1) to (c2);

    \fill[relE] (p11p2.south) ++(-0.5em, 0) circle[] coordinate (c1);
    \fill[relE] (p11p3.north) ++(-0.5em, 0) circle[] coordinate (c2);
    \draw[relE] (c1) to (c2);
  \end{scope}

  \begin{scope}[tolbrightRed, uncover=<2->]
    \node also [label=120:a] (p1);
    \node also [label=120:b] (p2);
    \node also [label=120:c] (p3);
    \node also [label=135:c] (p22e2);
    \node also [label=80:b] (p11p2);
    \node also [label=80:c] (p11p3);
  \end{scope}
\end{tikzpicture}
