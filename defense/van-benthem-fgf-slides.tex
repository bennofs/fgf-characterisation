\documentclass[169]{beamer}

\usetheme{auriga}
\input{settings/packages.tex}
\usepackage{appendixnumberbeamer}

%\includeonlyframes{current}

\lstset{upquote=true}
%\setsansfont[BoldFont={Fira Sans SemiBold}]{Fira Sans Book}
\makeatletter
\newlength\beamerleftmargin
\setlength\beamerleftmargin{\Gm@lmargin}
\makeatother

\hypersetup{bookmarks=true,colorlinks=true,allcolors=blue}

\title{A Constructive Proof of a Van~Benthem Theorem for the Forward Guarded Fragment of First~Order~Logic}
\author{Benno Fünfstück}
\institute{Master's defense}
\date{24.06.2024}

\include{tolcolors.tex}
\input{macros.tex}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{What is the ``Forward Guarded Fragment ($\FGF$)''?}
  \textbf{guarded}: quantification follows pattern ``$\exists{\elemtuplex} (\relR(\vartuplex, \vartupley) \land \varphi(\vartuplex, \vartupley))$''
  \vspace{0.5em}
  \begin{overprint}
    \onslide<-2>
      \begin{exampleblock}{Example 1}
        $\varphi_{1} = \exists{x_{1}x_{2}}\; (\relE(x_{1}, x_{2}) \land (\exists{x_{3}}(\relE(x_{2}, x_{3}) \land \relP(x_{3}))$
        \begin{center}
        \input{res/ex1.tex}
        \end{center}
      \end{exampleblock}
      \uncover<2>{
      \begin{alertblock}{Counterexample 1}
        $\varphi_{2} = \exists{x_{1}x_{2}}\; (\relE(x_{1}, x_{2}) \land (\exists{x_{3}}(\relE(x_{2}, x_{3}) \land \relE(x_{3}, x_{1}))$
        \begin{center}
        \input{res/counterex1.tex}
        \end{center}
      \end{alertblock}
      }
    \onslide<3->
      \begin{exampleblock}{More examples}
        \vspace{1em}
        \hspace{1em}
        \begin{minipage}{20em}
        $\varphi_{3} = \lnot \exists{x_{1}x_{2}}\; (\relG(x_{1}, x_{2}) \land \lnot \relE(x_{2}, x_{1}))$ \\[1em]
        $\varphi_{3} = \forall{x_{1}x_{2}}\; (\relG(x_{1}, x_{2}) \to \relE(x_{2}, x_{1}))$ \\[1em]
        $\varphi_{4} = \forall{x_{1}}\; (\relG(x_{1}, x_{1}) \to \exists{x_{2}} (\relP(x_{1},x_{2}, x_{1})))$
        \end{minipage}
      \end{exampleblock}
  \end{overprint}
\end{frame}

\begin{frame}{What is the ``Forward Guarded Fragment ($\FGF$)''?}
  \textbf{forward}: variables must appear in order $x_{1}$, $x_2$, \ldots
  \vspace{0.5em}
  \begin{alertblock}{Counterexamples}
    $\varphi_{3} = \forall{x_{1}x_{2}}\; (\relG(x_{1}, x_{2}) \to \relE(x_{2}, x_{1}))$ \\[1em]
    $\varphi_{5} = \exists{x_{1}}\; (\relE(x_{1}, x_{1}))$ \\[1em]
    $\varphi_{6} = \exists{x_{1}x_{2}x_{3}}\; (\relP(x_{1}, x_{2}, x_{3}) \land \relE(x_{1}, x_{3}))$ \\[1em]
    $\varphi_{7} = \exists{x_{2}x_{1}} \relE(x_{2}, x_{1})$
  \end{alertblock}

  \begin{exampleblock}{Examples}
    $\varphi_{1} = \exists{x_{1}x_{2}}\; (\relE(x_{1}, x_{2}) \land (\exists{x_{3}}(\relE(x_{2}, x_{3}) \land \relP(x_{3}))$ \\[1em]

    $\varphi_{8} = \exists{x_{1}x_{2}x_{3}}\; (\relP(x_{1}x_{2}x_{3}) \land \exists{x_{3}}(\relE(x_{2}, x_{3})))$ \\[1em]
    $\varphi_{9} = \exists{x_{1}x_{2}x_{3}}\; (\relP(x_{1}x_{2}x_{3}) \land \relE(x_{2}, x_{3}))$ \\[1em]
  \end{exampleblock}

  \vskip 0pt plus 1filll
\end{frame}

\begin{frame}{How expressive is $\FGF$?}
  \begin{center}
    \input{res/bisim1.tex}
  \end{center}
  \begin{itemize}
    \item \emph{FGF-bisimulation}: equivalence relation on structures
    \item $\FGF$-formulae are $\FGF$-bisimulation-invariant
    \item \textbf{Can we express all $\FGF$-bisimulation-invariant $\FO$-definable properties in $\FGF$?}
  \end{itemize}
\end{frame}

\begin{frame}\frametitle<1>{Van Benthem's theorem}\frametitle<2>{Van Benthem's theorem (finitary version)}
  \begin{theorem}[Van Benthem's theorem for $\FGF$]
    A first-order formula $\varphi$ is equivalent to some $\FGF$-formula\only<2>{ \textbf{over finite structures}} if and only if it is invariant under $\FGF$-bisimulation\only<2>{ \textbf{over finite structures}}.
  \end{theorem}
\end{frame}

\begin{frame}{Part 1 of 2}
  First, look at the simpler example of modal logic to introduce concepts
\end{frame}

\begin{frame}{Bisimulation for Modal Logic ($\ML$)}
  $\ML$ = quantification restricted to $\varphi(x) = \exists{y} (\relR(x,y) \land \psi(y))$
  \vspace{1em}
  \begin{definition}[$\ML$-bisimulation between $(\str{A}, s_{a})$ and $(\str{B}, s_{b})$]
    A $\ML$-bisimulation is a set $\mathcal{Z} \subseteq A \times B$ with $(s_{a}, s_{b}) \in \mathcal{Z}$ and:\\[0.5em]
      \textbf{(Atomic Harmony)} if $(a,b) \in \mathcal{Z}$, then $a \in p_{i}^{\mathcal{A}}$ if and only if $b \in p_{i}^{\mathcal{B}}$\\[0.5em]
      \textbf{(Forth)} if $(a,b) \in \mathcal{Z}$ and $(a,c) \in \relR^{\str{A}}$, there exists $d \in B$ with $(c,d) \in \mathcal{Z}$ and $(b,d) \in \relR^{\str{B}}$, and\\[0.5em]
      \textbf{(Back)} vice-versa of \textbf{(Forth)}.
  \end{definition}
\end{frame}

\begin{frame}{$\ML$-bisimulation example}
  \begin{center}
    \include{res/modal-bisim-ex1.tex}
  \end{center}
\end{frame}

\begin{frame}{$\ML$-bisimulation counterexample}
  \begin{center}
    \include{res/modal-bisim-ex2.tex}
  \end{center}
\end{frame}

\begin{frame}{Van Benthem for $\ML$}
  \begin{theorem}[Van Benthem's theorem for $\ML$]
    A first-order formula $\varphi$ is equivalent to some $\ML$-formula over finite structures if (and only if) it is invariant under $\ML$-bisimulation.
  \end{theorem}
\end{frame}

\begin{frame}[label=current]{$\ell$-bisimulation}
  A sequence of sets $\mathcal{Z}_{0} \supseteq \cdots \supseteq \mathcal{Z}_{\ell}$ is a \textbf{$\ell$-bisimulation} ($\bisimto^{\ell})$ if $\mathcal{Z}_{i}$ contains the witnesses for the back-and-forth conditions of $\mathcal{Z}_{i+1}$ and all $\mathcal{Z}_{i}$ satisfy atomic harmony.

  \vspace{1em}

  \begin{overprint}
    \onslide<1>
      The \textbf{quantifier rank $\qr(\varphi)$} is the maximum degree of nesting of quantifiers in $\varphi$.

      \begin{example}
        $\varphi(x) = \forall{y}\; (\relR(x,y) \to \exists{z} \relR(y,z)) \lor \exists{y}(\relR(x,y) \land \relP(y))$ has quantifier rank 2.
      \end{example}

      \vspace{1em}

      $\ML_{\ell}$ denotes the set of all $\ML$ formulae with quantifier rank at most $\ell$.
    \onslide<2>
      \begin{enumerate}
        \item $(\str{A}, a) \bisimto_{\ML}^{\ell} (\str{B}, b)$ if and only if $(\str{A}, a)$ and $(\str{B}, b)$ satisfy the same $\ML$ formulae with quantifier rank at most $\ell$.
        \item The number of $\bisimto_{\ML}^{\ell}$ equivalence classes is finite for fixed $\ell$.
        \item Any $\FO$ formula which is invariant under $\bisimto_{\ML}^{\ell}$ is equivalent to a formula of $\ML_{\ell}$.
      \end{enumerate}
  \end{overprint}
\end{frame}

\begin{frame}[label=current]{Tree unraveling}
  \input{res/ml-tree-unraveling}
\end{frame}

\begin{frame}[label=current]{$\ell$-locality}
  Let $\restr{\str{A}}{\mathcal{N}_{\ell}(a)}$ be the restriction of $\str{A}$ to all elements reachable through a path of length at most $\ell$ from $a$.%
  \vspace{-0.5em}
  \begin{center}
  \include{res/neigh-example.tex}
  \end{center}
  \vspace{-1em}
  A formula $\varphi(x)$ is $\ell$-local if $(\str{A}, a) \models \varphi \iff (\restr{\str{A}}{\mathcal{N}_{\ell}(a)}, a) \models \varphi$.\\[1em]
  $(\str{A}, a) \triangleq^{\ell} (\str{B}, b)$: structures satisfy the same $\ell$-local formulae.
\end{frame}

\begin{frame}[label=current]{Upgrading}
  \begin{center}
    \input{res/upgrading-ml}
  \end{center}
  \vspace{1em}
  \begin{enumerate}
    \item Let $(\str{A}, a) \models \varphi$ for some $\ell$-local $\varphi$
    \item $(\str{A}', a') \models \varphi$ by $\bisimto_{\ML}$-invariance
    \item $(\str{B}', b') \models \varphi$ by $\triangleq^{\ell}$-invariance
    \item $(\str{B}, b) \models \varphi$ by $\bisimto_{\ML}$-invariance
  \end{enumerate}
\end{frame}

\begin{frame}[label=current]{Proving van Benthem for $\ML$}

\end{frame}

\begin{frame}{Part 2 of 2}
  Now, adapt techniques to $\FGF$
\end{frame}

\begin{frame}{Bisimulation and van Benthem for FGF}

\end{frame}

\begin{frame}{Adapting the proof}

\end{frame}

\begin{frame}{Challenge 1: higher arity relations}

\end{frame}

\begin{frame}{HAH-unraveling}

\end{frame}

\begin{frame}{Problem with the HAH-unraveling}

\end{frame}

\begin{frame}{Game-based unraveling}

\end{frame}

\begin{frame}{Challenge 2: global modality and finiteness}

\end{frame}

\section{Conclusion}

\end{document}
